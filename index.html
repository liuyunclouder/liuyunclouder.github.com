<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  




<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Ezio's Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Ezio's Blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ezio's Blog">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>

  <title> Ezio's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?a63d6742fa06ccda252c7c1bdc9649d9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Ezio's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">record</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/22/Arsos — a lib search engine for coder/" itemprop="url">
                  Arsos — a lib search engine for coder
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-10-22T20:00:00+08:00" content="2016-10-22">
              2016-10-22
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/22/Arsos — a lib search engine for coder/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/22/Arsos — a lib search engine for coder/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Arsos，本来是二战时期协和国执行的一项搜寻德国原子核实验地点行动的名称，由于这项行动，协和国才真正了解了德国的原子核计划的真实进展，并成功破坏了其重水的来源。</p>
<p>同时，Arsos也是一个为工程师量身定做的搜索库和组件的Mac APP。</p>
<h3 id="由来"><a href="#由来" class="headerlink" title="由来"></a>由来</h3><p>Arsos来源于某天看到公司的前端工程师在查找一个js库，步骤非常繁琐：先打开浏览器，输入网址，然后输入angular，得到一长串结果，然后还要根据版本号筛选，如果想要找到angular下的cookie组件，还得Command + F，接下来输入cookie …脑细胞已阵亡。</p>
<p>作为一个熟练使用Alfred、Popclip、BTT的效率小能手（check 我自制的<a href="https://github.com/liuyunclouder/alfredworkflow" target="_blank" rel="external"> Alfred workflow</a> 、<a href="https://github.com/liuyunclouder/popclip_extension" target="_blank" rel="external"> Popclip extension </a>），简直不能忍，于是就萌生了自己做一个工具来简化这个流程。</p>
<h3 id="整体架构"><a href="#整体架构" class="headerlink" title="整体架构"></a>整体架构</h3><p><img src="http://d.pr/i/1fR5e+" alt=""><br>服务端由两个Server和一个Database组成（缓存没太大必要，文件存储暂时没太大需求，暂时Droplr够用）：Data Server负责收集数据并按照Service Server中定义的model的格式把数据保存到DB中，Service Server目前主要扮演API网关的角色，为Mac APP提供API接口，另外还会兼职Web Site中的展示和数据源后台管理。</p>
<p>客户端由Mac APP和Web Site组成：Mac APP主要对外提供搜索和下载服务，Web Site对外提供产品介绍的同时对内提供数据源管理服务，方便管理员编辑数据。</p>
<h3 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h3><p>作为一个Alfred重度患者，为了向Alfred致敬（是的，这不叫抄袭），UI设计和交互方式基本都是参照它来设计的，所以对用过Alfred的朋友来说是非常友好的，如果没用过Alfred也没关系，下面简单介绍下现有的功能。</p>
<h4 id="快速唤起"><a href="#快速唤起" class="headerlink" title="快速唤起"></a>快速唤起</h4><p>下载安装后（<a href="http://liuyunclouder.github.io/Arsos_site/" target="_blank" rel="external">下载地址</a>），运行Arsos，然后切换到其它应用，比如Atom或者sublime，按下快捷组合键：</p>
<p>Shift + 空格（自定义）</p>
<p>即可唤起Arsos进行搜索。</p>
<p><img src="http://d.pr/i/UPad+" alt=""></p>
<h4 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h4><p>搜索功能使用非常简单，输入的关键词以空格分割，回车后就会返回所有模糊匹配成功的结果。</p>
<p><img src="http://d.pr/i/bk1C+" alt=""></p>
<h4 id="复制"><a href="#复制" class="headerlink" title="复制"></a>复制</h4><p>在搜索结果列表中，使用上下箭头选中结果，回车即可复制选中结果到剪贴板中<br><img src="http://d.pr/i/1fXDD+" alt=""></p>
<p>另外，如果回车的同时按住option键，即可复制带有标签的结果<br><img src="http://d.pr/i/GP2I+" alt=""></p>
<h4 id="Alfred-workflow"><a href="#Alfred-workflow" class="headerlink" title="Alfred workflow"></a>Alfred workflow</h4><p>同时还给Alfred的重度患者提供一个workflow，作为Arsos Mac APP的精简版，<a href="https://github.com/liuyunclouder/alfredworkflow" target="_blank" rel="external">下载地址</a></p>
<h3 id="后续计划"><a href="#后续计划" class="headerlink" title="后续计划"></a>后续计划</h3><p>和几个朋友聊了下，收集了一些需求，加上自己也有些想法，于是功能列表变得越来越长<br><img src="http://d.pr/i/15SO9+" alt=""><br>我目前对这个工具的定位是一个纯粹的搜索工具，作为所有库和组件的搜索入口，所以不仅仅限于前端的内容，后续还会添加OC、Swift、Python、Ruby、Go等内容。<br>最后，有朋友对这个工具有什么建议可以留言。</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/15/回放机制/" itemprop="url">
                  回放机制
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-10-15T20:00:00+08:00" content="2016-10-15">
              2016-10-15
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/15/回放机制/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/15/回放机制/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近把《深入理解计算机系统》又看了一遍，除了复习了下编译链接和存储系统的知识外，还注意到一个很有意思的点：一个通用的回放机制。</p>
<h3 id="系统底层的回放机制：换页"><a href="#系统底层的回放机制：换页" class="headerlink" title="系统底层的回放机制：换页"></a>系统底层的回放机制：换页</h3><p><img src="http://d.pr/i/6hPB+" alt=""><br>计算机处于平衡读写速度和存储容量的目的，把存储划分为类似金字塔的各个层次，每一层都可以看作是对下层的缓存，这样，存储系统利用程序的时间和空间局部性，在能提供足够的容量的前提下也能保持高速的读写速度。</p>
<p>其中，操作系统会把内存和磁盘看做一个整体：虚拟内存。用户空间下的内存读写不会直接操作物理内存，而是通过虚拟内存来管理的。虚拟内存会根据需要在物理内存和磁盘中做不同的操作。</p>
<p>另外，出于节省物理内存以便同时运行多个任务的目的，操作系统在加载程序创建进程的时候不会把整个程序一次性都加载到物理内存中，而是只加载当前需要的一部分。于是，当需要读取的数据还没加载到物理内存中，操作系统就需要提供一套机制来尽快把需要的数据从磁盘加载到物理内存中。</p>
<p>这套机制就叫做换页（paging），而需要读取的数据还没加载到物理内存这种情况就叫做缺页。</p>
<p>当发生缺页时，也就是CPU发送的内存读写指令发现要读写的内存地址不在物理内存中，会出发一个异常而进入一个内核的异常处理流程：系统会把暂时不需要的物理内存中的数据存入磁盘，把目的内存地址所在的页（操作系统一般把大小为4K的内存数据划分为一页）加载进内存，同时会<em>重新执行之前CPU发送的内存读写指令</em>，这时需要的内存数据就已经在物理内存中了，同时相邻的内存数据也可以直接读取了。</p>
<p>“重新执行执行之前CPU发送的内存读写指令”。同样，OC也有类似的回放机制。</p>
<h3 id="OC-runtime的回放机制：消息发送"><a href="#OC-runtime的回放机制：消息发送" class="headerlink" title="OC runtime的回放机制：消息发送"></a>OC runtime的回放机制：消息发送</h3><p>OC 的runtime是这门语言的精髓，各种特性都离不开runtime。其中，runtime中的消息发送也有类似的回放机制。</p>
<p>当执行</p>
<pre><code>@interface EZObject : NSObject
@end

@implementation EZObject
static void lightup_imp(id self, SEL sel) {
    NSLog(@&quot;it&apos;s on fire!&quot;);
}

+ (BOOL)resolveInstanceMethod:(SEL)sel {
    if ([NSStringFromSelector(sel) isEqualToString:@&quot;lightup&quot;]) {
        class_addMethod([self class], sel, (IMP)lightup_imp, &quot;v@:&quot;);
    }

    return true;
}

@end

EZObject *ez_instance = [[EZObject alloc] init];
SEL lightup_sel = NSSelectorFromString(@&quot;lightup&quot;);
[ez_instance performSelector:lightup_sel];
</code></pre><p>时，无论是在EZObject还是NSObject，无论是类的cache还是method_list中都找不到lightup的实现，OC会调用EZObject的resolveInstanceMethod方法，来再次确认是否可以找出该方法，于是这里也就提供了一个机会让我们可以利用runtime的class_addMethod来创建一个OC的方法，创建好之后告诉OC现在有了light方法，于是OC<em> 再次向ez_instance发送lightup消息</em>，这次就可以成功找到并调用该方法了。</p>
<p>具体的实现由于NSObject所在的Foundation框架并没有开源，并不能确定，但参考cocoa的开源实现<a href="https://github.com/gnustep/base" target="_blank" rel="external"> GNUStep </a>，可以有一些收获。</p>
<p>在GSFFIInvocation.m中有这么一段代码：</p>
<pre><code>/**
 * Runtime hook used to provide message redirections with libobjc2.
 * If lookup fails but this function returns non-nil then the lookup
 * will be retried with the returned value.
 *
 * Note: Every message sent by this function MUST be understood by the
 * receiver.  If this is not the case then there is a potential for infinite
 * recursion.  
 */
static id gs_objc_proxy_lookup(id receiver, SEL op) {
    id cls = object_getClass(receiver);
    BOOL resolved = NO;

    /* Note that __GNU_LIBOBJC__ implements +resolveClassMethod: and
       +resolveInstanceMethod: directly in the runtime instead.  */

    /* Let the class try to add a method for this thing. */
    if (class_isMetaClass(cls)) {
        if (class_respondsToSelector(cls, @selector(resolveClassMethod: ))) {
            resolved = [receiver resolveClassMethod: op];
        }
    } else {
        if (class_respondsToSelector(object_getClass(cls),
                @selector(resolveInstanceMethod: ))) {
            resolved = [cls resolveInstanceMethod: op];
        }
    }
    if (resolved) {
        return receiver;
    }
    if (class_respondsToSelector(cls, @selector(forwardingTargetForSelector: ))) {
        return [receiver forwardingTargetForSelector: op];
    }
    return nil;
}
</code></pre><p>gs_objc_proxy_lookup函数就是完成方法查询的工作。大致意思就是如果查询失败但返回的是一个非nil对象，那么就会在这个非nil对象上重试查询。这样，就完成了消息发送时的回放机制。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>应用层的很多东西都是从操作系统学习过来的，比如类似kafka和rabbitmq等消息系统，都受到了操作系统的事件通知系统的启发，比如linux的inotify，毕竟普通应用要解决的问题基本上操作系统都已经解决过了，并且经过长时间的优化改进，架构设计都已经足够成熟和优雅，因此，了解底层的操作系统对解决上层应用碰到的问题还是很有帮助的。</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/08/iOS面试题/" itemprop="url">
                  iOS面试题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-10-08T20:00:00+08:00" content="2016-10-08">
              2016-10-08
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/08/iOS面试题/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/08/iOS面试题/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前帮朋友的公司面试iOS开发，于是列了个问题清单</p>
<h2 id="技术"><a href="#技术" class="headerlink" title="技术"></a>技术</h2><p>使用什么版本工具？git使用经历？</p>
<p>查看代码风格</p>
<p>聊下内存管理</p>
<p>说下多线程的认识和使用经历</p>
<p>面向对象思想</p>
<p>更多问题：<br><a href="">http://www.cnblogs.com/ios8/p/ios-oc-test.html</a></p>
<h3 id="UI布局"><a href="#UI布局" class="headerlink" title="UI布局"></a>UI布局</h3><p>View的生命周期<br>Autolayout<br>Core Animation<br>POP<br>UICollectionView<br>UITableView<br>reveal</p>
<h3 id="数据存储"><a href="#数据存储" class="headerlink" title="数据存储"></a>数据存储</h3><p>sqlite<br>core data<br>userdefaults<br>file</p>
<h3 id="网络交互"><a href="#网络交互" class="headerlink" title="网络交互"></a>网络交互</h3><p>AFNetworking<br>NSURLConnection<br>NSURLSession<br>SDWebImage<br>如何封装以适应具体业务</p>
<h3 id="调试思路"><a href="#调试思路" class="headerlink" title="调试思路"></a>调试思路</h3><p>哪些调试手段？<br>如何使用哪些工具优化内存？</p>
<h2 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h2><p>拿到一个需求后，如何开始做？</p>
<p>使用CoreLocation时遇到的问题</p>
<p>SDWebImage可以调整过期时间么？怎么调？</p>
<h2 id="沟通"><a href="#沟通" class="headerlink" title="沟通"></a>沟通</h2><p>说下你最近一个项目的经历？哪些让人不爽的情况？你是如何处理的？越详细越好</p>
<h2 id="视野"><a href="#视野" class="headerlink" title="视野"></a>视野</h2><p>有github账号么？</p>
<p>平时浏览哪些网站来学习iOS？</p>
<p>看过哪些iOS书籍？</p>
<h2 id="架构意识与设计"><a href="#架构意识与设计" class="headerlink" title="架构意识与设计"></a>架构意识与设计</h2><p>设计模式</p>
<p>有看过什么架构类书籍么？</p>
<p>一个列表，需要从cocoaChina上获取数据后显示，从UI布局到网络请求，如何设计？</p>
<h2 id="职业规划"><a href="#职业规划" class="headerlink" title="职业规划"></a>职业规划</h2><p>能描述下3年后你希望自己在技术上达到什么样的程度？在公司的位置是怎么样？</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/03/沟通是一种重要能力/" itemprop="url">
                  沟通是一种重要能力
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-10-03T20:00:00+08:00" content="2016-10-03">
              2016-10-03
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/03/沟通是一种重要能力/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/03/沟通是一种重要能力/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>现在要完成一个大一点的目标，经常需要多人协作，协作首先意味沟通，如果沟通不顺畅或者传达了错误的信息，那么就不可避免增加了协作的成本。</p>
<p>同样，和亲人朋友的相处是我们日常生活中很重要的一部分，因为我们的生活很大一部分都是与他们相关，频繁的接触意味着可能的摩擦，因此也就更需要良好的沟通能力才能维护好应有的亲密关系。</p>
<p>良好的沟通意味着准确的表达能力和优先善意地诠释他人传达的信息的能力。</p>
<h3 id="准确的表达能力"><a href="#准确的表达能力" class="headerlink" title="准确的表达能力"></a>准确的表达能力</h3><p>准确地传达你的信息，意味着：即使对方的诠释能力还有待提高或者不太愿意沟通，但也能更容易地理解你的意图。著名的“电梯测试”就是训练如何在乘坐电梯的这一小段时间内清晰准确地表达出你的信息。</p>
<p>作家通过文字来传达自己的意图，而文字作为视觉内容的一部分，比起电影电视剧，显然更难以表现出原本的意图和情感，所谓的“词不达意”就是形容文字没有很好地表达原本的内涵。由此，优秀的作家必须拥有比常人优秀的表达能力，最终才能通过文字这种单一的媒介描绘出复杂的世界、变幻的人心。我们喜爱读他们的作品也是部分因为我们能轻松地理解。</p>
<p>工作同样如此。好的工作环境，除了同事的平均技术能力和可口的零食水果，也应该包含和睦的同事关系和良好的沟通习惯。除了家人朋友，与同事的相处占据着我们生活中很大一部分时间，更多的相处意味着更可能的摩擦，如果能和同事保持愉快的合作关系，无论对工作效率的提升还是个人幸福感的提升，都是大有帮助。保持愉快的合作是一个需要双方努力的目标，除了对方的理解，还有自己的表达和付出。互惠原则很好地说明人性的特点，但其实互惠原则的本质在于对方接受了你的善意，因此我们不是一定需要某些物品才能让互惠原则生效，只要我们能让对方感受到我们友好的姿态也能让合作高效地进行下去。</p>
<p>当然，表达的形式不限于语言、文字，除了文学，音乐、绘画、影视等借助的方式都可以成为表达我们所思所想的工具。</p>
<p>表达的方式同样不止一种，除了直截了当，我们还可以委婉含蓄地表达自己的意图。除了准确性，表达的同时也应该照顾到对方的情感，不同的场景应该采用不同的方式。一般场景下，幽默的方式自然是他人最容易接受的方式，但如果是葬礼上，幽默一旦驾驭不好，很可能就会惹人不快。</p>
<h4 id="鸡和蛋"><a href="#鸡和蛋" class="headerlink" title="鸡和蛋"></a>鸡和蛋</h4><p>能否准确地表达，我觉得，不仅仅是沟通能力的一个方面，其实也是一个人层次高低的一个重要表现。</p>
<p>高层次的人普遍能抓住其表达主题的重点，并结合对方的关注点，有选择地调整表达的内容和重点，从而在对方兴趣消失前，持久地抓住对方的注意力。这种表达能力和表达技巧，会有助于获取更多的资源和帮助，从而获得更好的机会和结果。华尔街的路演和希特勒的演讲，都是优秀表达能力的例子。</p>
<p>那么，高层次的人更容易拥有优秀的表达能力？还是，优秀的表达能力帮助我们上升到更高层次？又是一个先有鸡还是先有蛋的故事。</p>
<h3 id="善意的诠释能力"><a href="#善意的诠释能力" class="headerlink" title="善意的诠释能力"></a>善意的诠释能力</h3><p>我一直认同“人性本恶”的说法。也许是因为经历了现实的挫折以及看了太多电影，目睹了太多人性的丑恶面，让我总是以一种防卫的姿态面对环境。直到近几年认识了一些朋友才让我扭转了这个消极的观念。</p>
<h4 id="哪来那么多坏人"><a href="#哪来那么多坏人" class="headerlink" title="哪来那么多坏人"></a>哪来那么多坏人</h4><p>回想起小时候，有一次和亲人坐火车出远门，路上遇到一个和我年龄差不多的小女孩，小孩子很容易就混熟了，于是就了解到她经常一个人坐火车往返于几千公里的两个城市，我当时就问她害怕不害怕路上遇到坏人，现在尽管早以忘记她的容貌，但她的回答我至今记得：“哪来那么多坏人，我碰到的都是好人啊”。</p>
<p>小孩子生来认为人人都应该是诚实善良，因为他们是小孩子。我们都曾经是个小孩子，都拥有一颗赤子之心。但随着年龄的增长，我们从周围从书本认识到世界上还有不怀好意，还有各种丑恶，天生的自卫机制让我们慢慢地失去了优先善意地诠释他人意图的能力。</p>
<p>但是“哪来那么多坏人？”。的确，现在是一个物欲横流的社会，我们想要的都太多，但由此就认为人人唯利是图，即使是成天周旋商界的最成功的商人也不会同意。每个人，只要不是穷凶极恶，内心都有自我认同机制，这种机制会根据自己的的行为在潜意识中塑造自己的自我形象：you are what you do。</p>
<p>人性本善。</p>
<h4 id="之乎者也"><a href="#之乎者也" class="headerlink" title="之乎者也"></a>之乎者也</h4><p>除了善意，我们还需要准确全面的诠释能力。</p>
<p>我们中学其实就已经在刻意地训练诠释能力了。阅读理解、作文是考试时必考的两项。除此之外，我觉得诗词的学习其实是更能训练我们的诠释能力。唐诗宋词，古人的这些作品，都是根据当时各自的背景和情境，以一种我们看来奇异的语法，用我们在日常生活中几乎早已不用的词句堆砌起来的，自然比普通的文章更让人难以理解和诠释。</p>
<p>了解作者当时的社会背景，对比他的个人情境，学习每个生僻的字词，拆分每个怪异的语法结构，我们最终能成功地准确诠释作者想要表达的意图。当然，每个人的诠释都是有偏差的，但重要的是我们刻意努力地想要理解这个早已不在人世的陌生人。</p>
<p>我们需要主动去理解他人以及他人的意图，锻炼自己的诠释能力。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>作为技术人的我们，很容易走入“硬技术”的死胡同，但其实世界不仅仅有技术，单纯的技术也不能“制霸”，历史上曾经就有很多牛逼的技术被埋没。换句话说，我们首先是人，然后才是技术人，而作为人，沟通能力在与人相处协作中是必不可缺的重要能力。</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/29/JSONizer：Popclip的JSON格式化扩展/" itemprop="url">
                  Popclip的JSON格式化扩展
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-09-29T20:00:00+08:00" content="2016-09-29">
              2016-09-29
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/29/JSONizer：Popclip的JSON格式化扩展/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/29/JSONizer：Popclip的JSON格式化扩展/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>作为一个MAC党，不好好利用MAC的神兵利器，简直就是罪过。Alfred、Dash、Ulysses、SnippetsLib、Mindnode等大名鼎鼎的效率神器自然不用提了，Popclip更是一个每天都会使用上百遍的好帮手。</p>
<h2 id="Popclip？"><a href="#Popclip？" class="headerlink" title="Popclip？"></a>Popclip？</h2><p>简单来说，Popclip就是一个对选中的内容作快速处理的工具，比如直接搜索选中的内容、从选中的内容生成二维码、计算选中的内容的字数等，除此之外，还能自定义扩展来实现你想要的功能。</p>
<p>这是我的Popclip扩展：<br><img src="http://d.pr/i/sfTc+" alt=""></p>
<p>如果你还没装Popclip，马上停下来，去安装一个，再继续看下去；</p>
<p>如果你不知道Popclip是什么，马上停下来，去看下这篇<a href="http://sspai.com/25483" target="_blank" rel="external">测评</a>，再继续看下去。</p>
<h2 id="JSONizer的来由"><a href="#JSONizer的来由" class="headerlink" title="JSONizer的来由"></a>JSONizer的来由</h2><p>平时经常需要对一坨字符进行格式化，那时每次都需要复制、打开<a href="http://jsbeautifier.org/" target="_blank" rel="external">jsbeautifier.org</a>、粘贴、点击格式化按钮，碰到网络不好的情况还要等半天，如果没网络，更是头疼。</p>
<p>后来改用sublime的插件CodeFormatter，也能比较方便地快速格式化，但还是有个点让我不开心：CodeFormatter要求必须先把需要格式化的内容保存在一个后缀为.json的文件中，才能识别并格式化。</p>
<p>由于用Popclip已经好一段时间了，很享受它提供的便利，于是就想装个JSON格式化扩展，搜了一下，发现竟然没有，于是就萌生了自己写一个的想法。</p>
<h2 id="动手"><a href="#动手" class="headerlink" title="动手"></a>动手</h2><p>JSON格式化的lib都已经很成熟了，正好在<a href="http://jsbeautifier.org/" target="_blank" rel="external">jsbeautifier.org</a>上看到有提供python的一个lib。</p>
<p>Popclip的扩展没有Alfred的workflow能提供的功能多而复杂，相应地也容易上手。参照<a href="http://computers.tutsplus.com/tutorials/popclip-scripting-extensions--mac-55842" target="_blank" rel="external">TUTS</a>上的这篇教程，几分钟就搞定了大致框架。</p>
<p>接下来就简单了，把依赖的几个lib依赖配好，基本文件布局如下：<br><img src="http://d.pr/i/V4JL+" alt=""></p>
<p>注：editorconfig、six.py是jsbeautifier的依赖项。</p>
<p>最后，测试效果完美：<br><img src="http://d.pr/i/hLal+" alt=""></p>
<p><a href="https://github.com/liuyunclouder/popclip_extension" target="_blank" rel="external"> 下载入口 </a>，希望能帮到需要的朋友。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>目前，需要先将需要格式化的内容拷贝到编辑器中，然后再选中才能格式化。其实还能改进一下，不需要拷贝，直接在内容来源上，比如浏览器中，选中需要格式化的字符并格式化，直接把格式化后的内容写入系统剪贴板。后续有时间可以研究下。</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/25/格局/" itemprop="url">
                  格局
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-09-25T20:00:00+08:00" content="2016-09-25">
              2016-09-25
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/25/格局/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/25/格局/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近杭州房价快速攀升，同一套房子，去年还是80万，今年120万还不一定买得到。考虑到一系列因素，我也开始准备买房了。</p>
<p><img src="http://d.pr/i/zMsG+" alt=""></p>
<h2 id="买房"><a href="#买房" class="headerlink" title="买房"></a>买房</h2><p>经过几天的看房-谈价格-房东加价-同意-房东不卖了，最终房子还是买到了。</p>
<p>虽然最终房子是买到了，价格确比去年高了几十万。忍不住想：要是去年买了就好了。</p>
<p>去年身边朋友和我一样都没买房，所以我没意识到需要在杭州买一套？不是的，来杭州已经快5年了，这5年间家人也催过买房要抓紧，同事也建议说现在可以入手一套，但每次都想都没想就以各种理由说不想买房。直到最近看了一本书，《软技能》，才意识到房地产投资是可以极大增加自己的个人资产。然后随着杭州房价的快速攀升，也忍不住出手了。</p>
<h2 id="格局"><a href="#格局" class="headerlink" title="格局"></a>格局</h2><p>身边的朋友去年买的房子现在已经涨了一倍了，如果我和他们同时买，现在也是身价好几百万的人了。后悔错过机遇是徒劳的，向前看才是最重要的。如果以后碰到类似的机遇，该如何才能把握住？</p>
<p>经常听人说类似的话：一个人的格局决定了他能达到的高度。这话听起来挺虚的，但其实往往是这类抽象而模棱两可的话说出了事物的真相。什么是格局？</p>
<p>百度百科里对格局的定义是这样的：</p>
<blockquote>
<p>格局，格是指以时间为格，局是指时间格子内所做事情以及事情的结果，合起来称之为格局。不同的人，在同一时间内所做的事情以及事情的结果不一样，所以说不同的人，格局不一样。<br>局势、态势的理解和把握。即一个人对事物所处的位置（时间和空间）及未来的变化的认知程度。</p>
</blockquote>
<p>说白了，就是要在不同的阶段做正确的事情。比如指挥战斗的将领，要运筹帷幄而决胜千里之外，比如政客，要懂得审时度势。</p>
<p>格局对一个人的影响如此重要，怎么提高自己的格局？为什么古时那些出生名门望族的子弟的格局基本都高于汲汲营营的底层百姓（现在其实也差不多）？为什么现在我们都逃出内陆，涌向沿海，逃出中国，涌向海外？除了外面的月亮比较圆、月饼更少添加剂以外，还因为我们都知道，视野对于格局的锻炼是非常重要的。</p>
<blockquote>
<p>You are what you read</p>
</blockquote>
<p>如果别人说：我吃过的盐比你走的路还多，我总是经不住想，你口味挺重的啊。但其实阅历对人的格局影响也是非常重要的。都说：</p>
<blockquote>
<p>要么读书要么旅行灵魂和身体必须有一个在路上</p>
</blockquote>
<p>阅历的增长，其实就是一个持续的“在路上“的过程。只有经历过类似的东西，当面对貌似熟悉的事物时，我们已收集的信息才有能力支撑起足够的信心去面对它。</p>
<h2 id="回到买房"><a href="#回到买房" class="headerlink" title="回到买房"></a>回到买房</h2><p>为什么即使在家人、同事的提醒下，我还是没动买房的心思？而同事却抓住了这个机遇？</p>
<p>其实是我那时一门心思花在工作和能力提升上，总觉得个人能力才是“硬通货”。这想法没错，刚毕业的小年轻本来就没太多资产，当务之急还是以工作技能为重。但就像格局的定义一样，在不同的阶段应该做不同的但正确的事情。对工作5年的我来说，还有更紧迫的事情。</p>
<p>同事从深圳过来，他经历过深圳房价腾飞的阶段，错过绝好的投资机会让他对投资理财有了更深刻的理解，而这时我们还是算计着网贷的收益要选8.1％还是9.3％的。</p>
<p>所以，其实我们都会经历过一些同样的阶段，还是那句老话：吃一堑，长一智。</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/18/最新Hopper破解版/" itemprop="url">
                  Hopper最新破解版
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-09-18T20:00:00+08:00" content="2016-09-18">
              2016-09-18
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/18/最新Hopper破解版/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/18/最新Hopper破解版/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>去年看完《iOS应用逆向工程》后玩了下hopper，<a href="http://bbs.iosre.com/" target="_blank" rel="external">http://bbs.iosre.com/</a>论坛里几个人在问Hopper的最新破解版，于是找了下，附上链接：<br><a href="http://xclient.info/s/hopper-disassembler.html" target="_blank" rel="external">http://xclient.info/s/hopper-disassembler.html</a></p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/17/使用Docker创建Elasticsearch服务/" itemprop="url">
                  使用Docker创建Elasticsearch服务
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-09-17T20:00:00+08:00" content="2016-09-17">
              2016-09-17
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/17/使用Docker创建Elasticsearch服务/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/17/使用Docker创建Elasticsearch服务/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近需要做的几个功能都是基于Elasticsearch，但又不想污染系统环境，所以就花了些时间研究下如何使用Docker创建Elastcisearch服务。</p>
<p>首先先分别了解下Docker和Elasticssearch。</p>
<h2 id="Docker是什么？"><a href="#Docker是什么？" class="headerlink" title="Docker是什么？"></a>Docker是什么？</h2><p>Docker是一个开源工具，能将一个WEB应用封装在一个轻量级，便携且独立的容器里，然后可以运行在几乎任何服务环境下。<br>Docker的容器能使应用跑在任何服务器上并且表现一致。一个开发者在笔记本上建立的一个容器，能跑在很多环境下，如：测试环境，生产环境，虚拟机上，VPS，OpenStack集群，公用的电脑等等<br>Docker的一般使用在以下几点：<br>•    自动化打包和部署应用<br>•    创造一个轻量级的，私人的 PAAS 环境<br>•    自动化测试和连续的 整合/部署<br>•    部署WEB应用，数据库和后端服务</p>
<p>所以，Docker是一个系统级兼容的容器，它采用Linux Container技术构建一个虚拟环境，用户可以在这个环境下安装各种应用来提供服务，并且这个环境可以随时创建或销毁，不会影响宿主环境</p>
<h2 id="Elasticsearch是什么？"><a href="#Elasticsearch是什么？" class="headerlink" title="Elasticsearch是什么？"></a>Elasticsearch是什么？</h2><p>Elasticsearch也使用Java开发并使用Lucene作为其核心来实现所有索引和搜索的功能，但是它的目的是通过简单的RESTful API来隐藏Lucene的复杂性，从而让全文搜索变得简单。</p>
<p>不过，Elasticsearch不仅仅是Lucene和全文搜索，我们还能这样去描述它：<br>•    分布式的实时文件存储，每个字段都被索引并可被搜索<br>•    分布式的实时分析搜索引擎<br>•    可以扩展到上百台服务器，处理PB级结构化或非结构化数据</p>
<p>总之，ES是一个牛逼的搜索存储引擎</p>
<h2 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h2><p>Mac上安装Docker很简单，基本跟着<a href="https://docs.docker.com/docker-for-mac/" title="https://docs.docker.com/docker-for-mac/" target="_blank" rel="external">官网</a>的引导就可以顺利安装了，完成后确保Docker已启动，如下图<br><img src="http://d.pr/i/13gIp+" alt=""></p>
<h2 id="创建Docker-镜像"><a href="#创建Docker-镜像" class="headerlink" title="创建Docker 镜像"></a>创建Docker 镜像</h2><p>Elasticsearch官方在Docker Hub上已经有提供镜像，如果没有额外需求，执行下面这个命令就可以直接使用Elasticsearch官方提供的镜像：</p>
<pre><code>docker run -d -p 9200:9200 --name=&quot;es&quot; elasticsearch:2.3.5
</code></pre><p>但我还想额外装一个Elasticsearch的插件，方便调适，所以就自己做了一个镜像，<a href=""> Dockerfile </a></p>
<pre><code>FROM elasticsearch:2.3.5

RUN /usr/share/elasticsearch/bin/plugin install mobz/elasticsearch-head

EXPOSE 9200
</code></pre><p>进入Dockerfile所在的文件夹，执行以下命令：</p>
<pre><code>docker build --tag=es_ezio:2.3.5 .
</code></pre><p>然后执行</p>
<pre><code>docker ps
</code></pre><p>就能看到刚才创建的镜像了<br><img src="http://d.pr/i/1k6a8+" alt=""></p>
<h2 id="启动容器及服务"><a href="#启动容器及服务" class="headerlink" title="启动容器及服务"></a>启动容器及服务</h2><p>上一步我们只是制作了一个Docker镜像，还没有创建Docker容器。关于Docker中镜像和容器的关系，可以类比为操作系统中的程序和进程，或者面向对象语言中的Class和Instance。我们必须从镜像创建出容器才能运行我们的服务（也就是Elasticsearch服务）。</p>
<p>第一次创建Docker容器，执行以下命令：</p>
<pre><code>docker run -d -p 9200:9200 --name=&quot;es_ezio&quot; es_ezio:2.3.5
</code></pre><p>Elasticsearch的默认端口是9200，我们把宿主环境9200映射到Docker容器中的9200端口，这样我们就可以直接访问宿主环境的9200端口就可以访问到Docker容器中的Elasticsearch服务了，同时我们把这个容器命名为es_ezio。</p>
<p>如果一切顺利，访问 <a href="http://127.0.0.1:9200/_plugin/head/" target="_blank" rel="external">http://127.0.0.1:9200/_plugin/head/</a><br><img src="http://d.pr/i/n8i8+" alt=""></p>
<p>这样，我们就完成了用Docker提供Elasticsearch服务，而不污染宿主机环境了，这样还有一个好处，如果想同时启动多个不同版本的Elastcsearch或者其他服务，Docker也是一个理想的解决方案。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Docker主要是面向运维部署，但其实对开发人员来说也是一个不错的playground，后续我的个人服务会尽量都采用Docker的方式部署。<br>Elastic search是一个功能强大的搜索存储引擎，特别是它强大的全文搜索能力，要好好研究下。</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/30/关于几个初始化shell文件/" itemprop="url">
                  关于几个初始化shell文件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-08-30T20:00:00+08:00" content="2016-08-30">
              2016-08-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/30/关于几个初始化shell文件/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/30/关于几个初始化shell文件/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>shell在类linux系统中扮演的角色非常重要，连操作系统启动的入口一般都是shell，一般类linux系统启动时会涉及到这几个shell脚本，今天就来看看这几个脚本的作用</p>
<h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><p>/etc/profile:此文件为系统的每个用户设置环境信息,当用户第一次登录时,该文件被执行. 并从/etc/profile.d目录的配置文件中搜集shell的设置. </p>
<p>/etc/bashrc:为每一个运行bash shell的用户执行此文件.当bash shell被打开时,该文件被读取. </p>
<p>~/.bash_profile:每个用户都可使用该文件输入专用于自己使用的shell信息,当用户登录时,该 文件仅仅执行一次!默认情况下,他设置一些环境变量,执行用户的.bashrc文件. </p>
<p>~/.bashrc:该文件包含专用于你的bash shell的bash信息,当登录时以及每次打开新的shell时,该 该文件被读取. </p>
<p>另外,/etc/profile中设定的变量(全局)的可以作用于任何用户,而~/.bashrc等中设定的变量(局部)只能继承/etc/profile中的变量,他们是”父子”关系. </p>
<p>~/.bash_profile 是交互式、login 方式进入 bash 运行的<br>~/.bashrc 是交互式 non-login 方式进入 bash 运行的<br>通常二者设置大致相同，所以通常前者会调用后者。 </p>
<h2 id="MAC-OS"><a href="#MAC-OS" class="headerlink" title="MAC OS"></a>MAC OS</h2><p>MAC OS上的shell执行顺序有点特殊：<br>/etc/profile ->~/.bashrc(or .zshrc) -> /etc/bashrc</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/14/关于跨域的一些事/" itemprop="url">
                  关于跨域的一些事
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-07-14T20:00:00+08:00" content="2016-07-14">
              2016-07-14
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/07/14/关于跨域的一些事/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/07/14/关于跨域的一些事/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>web前端开发中，我们经常需要访问除了源服务器（输出当前页面的服务器）外的服务，这时由于浏览器同源策略<a href="https://en.wikipedia.org/wiki/Same-origin_policy" target="_blank" rel="external">https://en.wikipedia.org/wiki/Same-origin_policy</a>的限制，我们需要做很多额外的修改才能达到目的。而在web后端开发中，我们可以直接从一个服务器发送请求到另一个服务器，由于不存在浏览器做中介，所以可以很方便地进行通信，诞生了各种RPC框架，这些框架的底层通信模块常见的基本都是使用socket、HTTP、PB（Protocol Buffers）等通信协议。这篇文章只说在浏览器参与的跨域中的情况。</p>
<p>跨域分两种：跨子域和跨全域。从easydb.dtstack.com发送HTTPRequest到www.dtstack.com，这样的叫跨子域；从www.baidu.com发送HTTPRequest到www.dtstack.com，这样的叫跨全域。</p>
<p>关于跨域通信，目前已经有了很多方法，最常见的就是JSONP，但JSONP和<br>Ajax并不相同。Ajax<a href="https://zh.wikipedia.org/zh/AJAX" target="_blank" rel="external">https://zh.wikipedia.org/zh/AJAX</a>通常都是通过新建XMLHTTPRequest（IE下还有类似XMLDomainRequest）来创建请求，而JSONP的本质其实是利用向DOM中插入script标签来“触发”请求，因此JSONP不会受到浏览器同源策略的影响。因此，许多web service都是通过JSONP实现。但JSONP任何人都能调用，无形中放大了服务器的潜在bug危害，因此我们还会时不时地用到Ajax。接下来我们就来聊聊Django中常见的Ajax跨域解决方案。</p>
<h2 id="跨子域"><a href="#跨子域" class="headerlink" title="跨子域"></a>跨子域</h2><p>解决跨子域有纯前端的方案，比如从easydb.dtstack.com跨子域访问www.dtstack.com，只需要在JS中设置<br><code>document.domain = &#39;dtstack.com&#39;</code><br>然后正常发送请求就行了。</p>
<p>也有前后端配合的方案，可以参考跨全域的方案。</p>
<h2 id="跨全域"><a href="#跨全域" class="headerlink" title="跨全域"></a>跨全域</h2><p>跨全域通信的关键在于被访问的服务器允许访问方进行访问。</p>
<p>因此，一般发送跨域请求时，浏览器会“询问”服务器是否允许当前请求进行访问，“询问”的方式是通过发送一个OPTIONS请求，这时被访问服务器需要返回一些信息表示是否允许，这些信息一般放在HTTP header中。这样，如果被访问服务器返回表示允许访问的HTTP header，那么浏览器就会发送用户创建的跨域请求，这样就完成了跨域通信了。</p>
<p>基本原理弄清楚了，接下来就是实现细节了。</p>
<p>Django中，我们可以添加一个中间件来为跨域请求设置恰当的HTTP header。首先创建一个cross_domain_middleware.py文件</p>
<pre><code>from dtuic.settings import ALLOWED_HOSTS_FOR_MIDDLEWARE

class CrossDomainMiddleware(object):

    def process_response(self, request, response):

        origin = request.META.get(&apos;HTTP_ORIGIN&apos;)
        allowed_hosts = self.get_allowed_hosts(request)

        if origin in allowed_hosts or &apos;*&apos; in allowed_hosts:
            response[&quot;Access-Control-Allow-Headers&quot;] = &quot;Origin, X-Requested-With, Content-Type, Accept, Key, source&quot;
            response[&quot;Access-Control-Allow-Methods&quot;] = &quot;POST, GET, OPTIONS, DELETE, PUT&quot;
            response[&quot;Access-Control-Allow-Origin&quot;] = origin
            response[&quot;Access-Control-Max-Age&quot;] = &quot;1000&quot;
            response[&apos;Access-Control-Allow-Credentials&apos;] = &quot;true&quot;

        return response

    def get_allowed_hosts(self, request):
        hosts = []
        for host in ALLOWED_HOSTS_FOR_MIDDLEWARE.split(&apos;,&apos;):
            host = host.strip()
            if host != &apos;*&apos;:
                host = &quot;{}://{}&quot;.format(request.scheme, host)

            hosts.append(host)

        return hosts
</code></pre><p>，同时在settings文件中添加</p>
<pre><code>ALLOWED\_HOSTS\_FOR\_MIDDLEWARE = &quot;www.baidu.com, www.whatever.com&quot;
</code></pre><p>，最后在Django的middleware配置中添加我们新建的cross_domain_middleware</p>
<pre><code>MIDDLEWARECLASSES = (
&apos;dtuic.middleware.crossdomainmiddleware.CrossDomainMiddleware&apos;,
&apos;django.contrib.sessions.middleware.SessionMiddleware&apos;,
...
)
</code></pre><p>放在最前面，见<a href="">https://docs.djangoproject.com/en/1.10/ref/settings/#allowed-hosts</a></p>
<p>目前ALLOWED_HOSTS_FOR_MIDDLEWARE 只支持多个域名显示配置，也可以使用正则动态匹配。</p>
<p>注意Django中的ALLOWED_HOSTS并不是为了跨域的配置，而是针对全局请求访问的一个配置，如果直接覆盖，可能会导致全站400，本地开发时由于Django的调适标识Debug都为True，Django这时是默认允许所有请求访问的，所以即使覆盖了ALLOWED_HOSTS也不会有问题，而到了线上，Debug切换到False，就会有“惊喜”了。</p>
<p>参考：<br><a href="">http://www.html5rocks.com/en/tutorials/cors/</a></p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpeg"
               alt="Ezio" />
          <p class="site-author-name" itemprop="name">Ezio</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">15</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ezio</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"githubliuyunclouder"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  

  

  

</body>
</html>
